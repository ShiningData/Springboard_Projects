import pandas as pd
import re

# Sample DataFrame
data = {
    'bank_name': ['TEXASCREDIT UNION', 'ABC Bank', 'DEF CREDIT UNION', 'GHI Bank'],
    'formatted_bank_name': ['TEXASCREDIT UNION', 'ABC Bank', 'DEF CREDIT UNION', 'GHI Bank']
}

df = pd.DataFrame(data)

# Function to separate 'CREDIT UNION' if not separately written
def separate_credit_union(name):
    # Use regular expression to insert space before 'CREDIT UNION' if not separately written
    return re.sub(r'(?<!\bCREDIT) UNION\b', ' CREDIT UNION', name)

# Apply the function to the 'bank_name' column
df['bank_name'] = df['bank_name'].apply(separate_credit_union)

print(df)
