from pyspark.sql.functions import concat_ws, lit, to_date

# Add the 'execution_date' column
prt_agg_df = prt_agg_df.withColumn(
    "execution_date",
    to_date(concat_ws("-", prt_agg_df.execution_year, prt_agg_df.execution_month, lit("01")))
)

# Select and reorder columns
prt_agg_df = prt_agg_df.select(
    "uid_prules", "execution_month", "execution_year", "execution_date", "num_executions"
)

# Show the updated DataFrame
prt_agg_df.show()
