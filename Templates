WITH 
prev_day AS (
  SELECT 
    segment, 
    date_dt, 
    tran_direction, 
    SUM(transaction_count) OVER (PARTITION BY segment, tran_direction ORDER BY date_dt ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) as prev_day_tran_count,
    SUM(transaction_amount) OVER (PARTITION BY segment, tran_direction ORDER BY date_dt ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) as prev_day_tran_amount
  FROM 
    your_table
),

day_before_prev AS (
  SELECT 
    segment, 
    date_dt, 
    tran_direction, 
    SUM(transaction_count) OVER (PARTITION BY segment, tran_direction ORDER BY date_dt ROWS BETWEEN 2 PRECEDING AND 2 PRECEDING) as day_before_tran_count,
    SUM(transaction_amount) OVER (PARTITION BY segment, tran_direction ORDER BY date_dt ROWS BETWEEN 2 PRECEDING AND 2 PRECEDING) as day_before_tran_amount
  FROM 
    your_table
)

SELECT 
  prev_day.segment, 
  prev_day.date_dt,
  prev_day.tran_direction,
  prev_day.prev_day_tran_count as total_tran_count, 
  (prev_day.prev_day_tran_count - day_before_prev.day_before_tran_count) / day_before_prev.day_before_tran_count * 100 as percent_change_count, 
  prev_day.prev_day_tran_amount as total_tran_amt, 
  (prev_day.prev_day_tran_amount - day_before_prev.day_before_tran_amount) / day_before_prev.day_before_tran_amount * 100 as percent_change_amt 
FROM 
  prev_day 
JOIN 
  day_before_prev 
ON 
  prev_day.segment = day_before_prev.segment AND 
  prev_day.date_dt = day_before_prev.date_dt AND
  prev_day.tran_direction = day_before_prev.tran_direction
