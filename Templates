def validate_model_prediction(
  prediction,
  total_count,
  NameMtch,
  BusNameMtch,
  AddressMtch, 
  CityMtch,
  StateMtch,
  ZipMtch,
  HmPhoneMtch,
  WkPhoneMtch,
  SSNMtch,
  DOBMtch
  ):
    # Group the keys into categories (each group represents one mismatch category)
    mismatch_keys = [
      ["NameMtch"],
      ["BusNameMtch"],
      ["AddressMtch", "CityMtch", "StateMtch", "ZipMtch"],
      ["HmPhoneMtch", "WkPhoneMtch"], 
      ["SSNMtch"],
      ["DOBMatch"]
    ]

    # Sum the mismatches per category
    total_count = sum(count_mismatch_category(category) for category in mismatch_keys)

    # Helper function to check if any of the match columns is 'N' or 'C'
    def check_any_match(*columns):
        return any(c in ['N', 'C'] for c in columns)

    # Condition for prediction "CRC1100"
    if prediction == "CRC1100":
        if total_count == 0:
            return 'CRC1100'
        elif total_count == 1:
            if check_any_match(NameMtch, BusNameMtch):
                return 'CRC3100'
            if SSNMtch in ['N', 'C']:
                return 'CRC3200'
            if DOBMtch in ['N', 'C']:
                return 'CRC3300'
            if check_any_match(AddressMtch, CityMtch, StateMtch, ZipMtch):
                return 'CRC2100'
            if check_any_match(HmPhoneMtch, WkPhoneMtch):
                return 'CRC2200'
        elif total_count > 1:
            if check_any_match(NameMtch, BusNameMtch) and check_any_match(SSNMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if SSNMtch in ['N', 'C'] and check_any_match(NameMtch, BusNameMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if check_any_match(DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC3400'

    # Condition for prediction "CRC3100"
    elif prediction == "CRC3100":
        if total_count == 1:
            if check_any_match(NameMtch, BusNameMtch):
                return 'CRC3100'
            if SSNMtch in ['N', 'C']:
                return 'CRC3200'
            if DOBMtch in ['N', 'C']:
                return 'CRC3300'
            if check_any_match(AddressMtch, CityMtch, StateMtch, ZipMtch):
                return 'CRC2100'
            if check_any_match(HmPhoneMtch, WkPhoneMtch):
                return 'CRC2200'
        elif total_count > 1:
            if check_any_match(NameMtch, BusNameMtch) and check_any_match(SSNMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if SSNMtch in ['N', 'C'] and check_any_match(NameMtch, BusNameMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if check_any_match(DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC3400'

    # Condition for prediction "CRC3200"
    elif prediction == "CRC3200":
        if total_count == 1:
            if SSNMtch in ['N', 'C']:
                return 'CRC3200'
            if check_any_match(NameMtch, BusNameMtch):
                return 'CRC3100'
            if DOBMtch in ['N', 'C']:
                return 'CRC3300'
            if check_any_match(AddressMtch, CityMtch, StateMtch, ZipMtch):
                return 'CRC2100'
            if check_any_match(HmPhoneMtch, WkPhoneMtch):
                return 'CRC2200'
        elif total_count > 1:
            if check_any_match(NameMtch, BusNameMtch) and check_any_match(SSNMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if SSNMtch in ['N', 'C'] and check_any_match(NameMtch, BusNameMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if check_any_match(DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC3400'

    # Condition for prediction "CRC3300"
    elif prediction == "CRC3300":
        if total_count == 1:
            if DOBMtch in ['N', 'C']:
                return 'CRC3300'
            if check_any_match(NameMtch, BusNameMtch):
                return 'CRC3100'
            if SSNMtch in ['N', 'C']:
                return 'CRC3200'
            if check_any_match(AddressMtch, CityMtch, StateMtch, ZipMtch):
                return 'CRC2100'
            if check_any_match(HmPhoneMtch, WkPhoneMtch):
                return 'CRC2200'
        elif total_count > 1:
            if check_any_match(NameMtch, BusNameMtch) and check_any_match(SSNMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if SSNMtch in ['N', 'C'] and check_any_match(NameMtch, BusNameMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if check_any_match(DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC3400'

    # Condition for prediction "CRC2100"
    elif prediction == "CRC2100":
        if total_count == 1:
            if check_any_match(AddressMtch, CityMtch, StateMtch, ZipMtch):
                return 'CRC2100'
            if check_any_match(NameMtch, BusNameMtch):
                return 'CRC3100'
            if SSNMtch in ['N', 'C']:
                return 'CRC3200'
            if DOBMtch in ['N', 'C']:
                return 'CRC3300'
            if check_any_match(HmPhoneMtch, WkPhoneMtch):
                return 'CRC2200'
        elif total_count > 1:
            if check_any_match(NameMtch, BusNameMtch) and check_any_match(SSNMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if SSNMtch in ['N', 'C'] and check_any_match(NameMtch, BusNameMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if check_any_match(DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC3400'

    # Condition for prediction "CRC2200"
    elif prediction == "CRC2200":
        if total_count == 1:
            if check_any_match(HmPhoneMtch, WkPhoneMtch):
                return 'CRC2200'
            if check_any_match(NameMtch, BusNameMtch):
                return 'CRC3100'
            if SSNMtch in ['N', 'C']:
                return 'CRC3200'
            if DOBMtch in ['N', 'C']:
                return 'CRC3300'
            if check_any_match(AddressMtch, CityMtch, StateMtch, ZipMtch):
                return 'CRC2100'
        elif total_count > 1:
            if check_any_match(NameMtch, BusNameMtch) and check_any_match(SSNMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if SSNMtch in ['N', 'C'] and check_any_match(NameMtch, BusNameMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if check_any_match(DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC3400'

    # Condition for prediction "CRC3400"
    elif prediction == "CRC3400":
        if total_count > 1:
            if check_any_match(DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC3400'
            if check_any_match(NameMtch, BusNameMtch) and check_any_match(SSNMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if SSNMtch in ['N', 'C'] and check_any_match(NameMtch, BusNameMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
        if total_count == 1:
            if check_any_match(HmPhoneMtch, WkPhoneMtch):
                return 'CRC2200'
            if check_any_match(NameMtch, BusNameMtch):
                return 'CRC3100'
            if SSNMtch in ['N', 'C']:
                return 'CRC3200'
            if DOBMtch in ['N', 'C']:
                return 'CRC3300'

    # Condition for prediction "CRC4100"
    elif prediction == "CRC4100":
        if total_count > 1:
            if check_any_match(NameMtch, BusNameMtch) and check_any_match(SSNMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if SSNMtch in ['N', 'C'] and check_any_match(NameMtch, BusNameMtch, DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC4100'
            if check_any_match(DOBMtch, AddressMtch, CityMtch, StateMtch, ZipMtch, HmPhoneMtch, WkPhoneMtch):
                return 'CRC3400'
        if total_count == 1:
            if check_any_match(HmPhoneMtch, WkPhoneMtch):
                return 'CRC2200'
            if check_any_match(NameMtch, BusNameMtch):
                return 'CRC3100'
            if SSNMtch in ['N', 'C']:
                return 'CRC3200'
            if DOBMtch in ['N', 'C']:
                return 'CRC3300'

    # Default fallback if no conditions matched
    return prediction
