from pyspark.sql import SparkSession
from pyspark.sql.window import Window
from pyspark.sql.functions import dense_rank, col

# Initialize Spark Session
spark = SparkSession.builder.appName("Dense Rank Column Values").getOrCreate()

# Assuming 'df' is your PySpark DataFrame

# Define a window specification for ordering
windowSpec = Window.orderBy(col("2023-10-01").desc())  # Change to .asc() for ascending order

# Rank the '2023-10-01' column using dense_rank and create a new column 'dense_rank'
df = df.withColumn("dense_rank", dense_rank().over(windowSpec))

# Show the result (optional)
df.show()
