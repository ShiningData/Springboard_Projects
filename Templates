import pandas as pd

# Assuming df is your DataFrame
# Replace 'your_dataframe.csv' with your actual file
# df = pd.read_csv('your_dataframe.csv')

# Function to get the longest naics_desc for a given cust_id
def get_longest_naics_desc(group):
    return group.loc[group['naics_desc'].str.len().idxmax()]

# Group by cust_id and apply the function
longest_naics_desc = df.groupby('cust_id').apply(get_longest_naics_desc)

# Merge the original df with the longest naics_desc on cust_id
df = df.drop('naics_desc', axis=1).merge(longest_naics_desc[['cust_id', 'naics_desc']], on='cust_id')

# If you want to save the updated DataFrame
# df.to_csv('updated_dataframe.csv', index=False)
