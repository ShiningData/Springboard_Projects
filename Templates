import pandas as pd
import plotly.graph_objects as go

# Assuming df_tran is your DataFrame and already processed for conditional formatting

# create a list of conditions for symbols
symbols = []
for _, row in df_tran.iterrows():
    if row['total_tran_count'] > row['pre_total_tran_count']:
        symbols.append('▲')
    elif row['total_tran_count'] < row['pre_total_tran_count']:
        symbols.append('▼')
    else:
        symbols.append('')
df_tran['total_tran_count_symbol'] = symbols

symbols = []
for _, row in df_tran.iterrows():
    if row['total_tran_amt'] > row['pre_total_tran_amt']:
        symbols.append('▲')
    elif row['total_tran_amt'] < row['pre_total_tran_amt']:
        symbols.append('▼')
    else:
        symbols.append('')
df_tran['total_tran_amt_symbol'] = symbols

symbols = []
for _, row in df_tran.iterrows():
    if row['num_active_clients'] > row['pre_num_active_clients']:
        symbols.append('▲')
    elif row['num_active_clients'] < row['pre_num_active_clients']:
        symbols.append('▼')
    else:
        symbols.append('')
df_tran['num_active_clients_symbol'] = symbols

# Create a trace for table
trace = go.Table(
    header=dict(values=list(df_tran.columns),
                fill_color='paleturquoise',
                align='left'),
    cells=dict(values=[df_tran['segment'], df_tran['frequency'], 
                       df_tran['total_tran_count'].astype(str) + ' ' + df_tran['total_tran_count_symbol'], 
                       df_tran['total_tran_amt'].astype(str) + ' ' + df_tran['total_tran_amt_symbol'], 
                       df_tran['num_active_clients'].astype(str) + ' ' + df_tran['num_active_clients_symbol']],
               fill_color='lavender',
               align='left'))

# Add trace to a figure
fig = go.Figure(data=[trace])

fig.show()
