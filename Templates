import pandas as pd

# Read the original CSV file
file_path = 'your_file.csv'  # Replace with your actual file path
df = pd.read_csv(file_path)

# Calculate the number of times we need to replicate the original rows
num_original_rows = len(df)
num_target_rows = 4358

# If the original number of rows is greater than the target, we cannot proceed
if num_original_rows > num_target_rows:
    raise ValueError("The number of original rows is greater than the target number of rows.")

# Calculate the number of times we need to replicate the original rows
num_repeats = (num_target_rows // num_original_rows) + 1

# Replicate the rows
expanded_df = pd.concat([df] * num_repeats, ignore_index=True)

# Trim the DataFrame to the target number of rows
expanded_df = expanded_df.iloc[:num_target_rows]

# Save the expanded DataFrame to a new CSV file
output_file_path = 'expanded_file.csv'  # Replace with your desired output file path
expanded_df.to_csv(output_file_path, index=False)

print(f"The CSV file has been expanded to {num_target_rows} rows and saved to {output_file_path}")
