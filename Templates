from sklearn.metrics import auc

# Precision-Recall curve
logger.info("Plotting Precision-Recall curve...")
precision, recall, _ = precision_recall_curve(y_test, model.predict_proba(X_test)[:, 1])
pr_auc = auc(recall, precision)

plt.figure(figsize=(10, 7))
plt.plot(recall, precision, marker='.', label=f'PR Curve (AUC = {pr_auc:.2f})')
plt.xlabel('Recall')
plt.ylabel('Precision')
plt.title(f'Precision-Recall Curve (AUC = {pr_auc:.2f})')
plt.grid(True)
plt.legend(loc="lower left")
plt.savefig(output_path / "precision_recall_curve.png")
plt.close()
