import pandas as pd
import plotly.graph_objects as go
from ipywidgets import widgets
from IPython.display import display

# Assuming df_tran is your DataFrame

# Dropdown widgets
tran_dir_dropdown = widgets.Dropdown(options=df_tran['tran_direction'].unique(), description='Transaction Direction:')
freq_dropdown = widgets.Dropdown(options=df_tran['frequency'].unique(), description='Frequency:')

# Display the dropdowns
display(tran_dir_dropdown, freq_dropdown)

def create_table(tran_dir, freq):
    filtered_df = df_tran[(df_tran['tran_direction'] == tran_dir) & (df_tran['frequency'] == freq)]

    fig = go.Figure(data=[go.Table(
        header=dict(values=list(filtered_df.columns), fill_color='paleturquoise', align='left'),
        cells=dict(values=[filtered_df[column] for column in filtered_df.columns], fill_color='lavender', align='left')
    )])
    fig.update_layout(title='Most Active Segments by Wire Transactions')

    fig.show()

# Create button to update table
update_button = widgets.Button(description='Update Table')

def on_button_clicked(b):
    create_table(tran_dir_dropdown.value, freq_dropdown.value)

update_button.on_click(on_button_clicked)
display(update_button)
