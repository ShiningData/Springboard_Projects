import pandas as pd
import plotly.graph_objects as go

# Assuming you already have a DataFrame named "wire_segment"

# Let's sort the dataframe based on total_tran_count in descending order
wire_segment = wire_segment.sort_values('total_tran_count', ascending=False)

# Create a list of unique transaction directions
tran_directions = wire_segment['tran_direction'].unique()

# Creating list of data for each transaction direction
data = [go.Table(header=dict(values=list(wire_segment.columns)),
                 cells=dict(values=[wire_segment[wire_segment['tran_direction'] == tran_direction][col] 
                                    for col in wire_segment.columns]),
                 visible = (tran_direction == tran_directions[0])) 
        for tran_direction in tran_directions]

# Creating the layout and the dropdown menu
layout = go.Layout(
    title="Wire Segment Data",
    updatemenus=[
        dict(
            buttons=list([
                dict(
                    args=[{"visible": [tran_direction == item for tran_direction in tran_directions]}],
                    label=item,
                    method="update"
                ) for item in tran_directions
            ]),
            direction="down",
            pad={"r": 10, "t": 10},
            showactive=True,
            x=0.1,
            xanchor="left",
            y=1.1,
            yanchor="top"
        ),
    ]
)

# Creating the figure
fig = go.Figure(data=data, layout=layout)

# Display the figure
fig.show()
