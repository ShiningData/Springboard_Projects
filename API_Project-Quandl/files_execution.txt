
Background on Payment Systems
- The speaker's team helped other payments teams by running code to move data around.
- The root cause of issues was the bank's numerous payment systems.


PSG and Payment Processing
- PSG (Payment Staging Area) collects payments from different input sources and standardizes the format.
- Debulking involves opening a file, examining individual payments, adding metadata, and reformatting.
- Bulking involves reassembling the payments into another version of the same file before sending it to PME.
- An issue occurred between debulking and bulking where payments were either duplicated or dropped.
  - Duplicated payments resulted in customers being paid twice.
  - Dropped payments resulted in missed payments, with PNC covering the loss.


PME and Related Systems
- Other systems like ACH and PME also experienced issues.
- PME was originally GPP (Global Payments Platform).
- Due to the Fed ISO change, another application called IPF was created.
- PME (Payments Engine) uses GPP, a vendor tool.
- There are two versions of the GPP tool managed by the PME team: PME and PRT.
  - PME and PRT are at slightly different versions of the GPP tool.
  - PME handles Fedwire, Swift, and Swift pass-through payments.
  - PRT handles CHIPS, ILV (International Low Volume payments), Canada wires, Canada ACH, and RTP.
- Cross signs on a diagram represent potential breaking points in the system.


ACH Payment Platforms
- There are three payment processing platforms for ACH.
- The speaker is trying to find the names of the ACH platforms.


- There are three different processing platforms for ACH: AUTP, ACH, and AUTYP.
- The speaker does not know what these acronyms stand for.
- The ACH flow involves files from PSG going to one of the three ACH platforms, which then send data to TCH.
- A subset of these platforms may also send data to the Fed ACH Network.


Wires vs ACH
- For US wires, the Fed Wire Network and Swift Network are handled by the Fed.
- CHIPS goes to the TCH network (The Clearing House).
- ACH stands for Automated Clearinghouse.


International Payments
- International low volume payments go through Visa.
- Canada wires and ACH payments go to the Royal Bank of Canada (RBC).


Payment Staging Area (PSG)
- PSG collects files for ACH in addition to wires.
- PSG handles ACH differently; it doesn't do debulking and bulking for batch ACH like it does for wires.
- For API ACHs, PSG may do debulking and bulking.
- Batch ACH refers to a file containing information on what ACH payments need to be made.
- PNC only knows what transactions are in the ACH file inside the ACH processing platforms (AUTP, ACH, or AUTYP).
- If there are duplicate transactions, they are caught at the processing platform stage, but ideally, they should be caught earlier.


ACH Initiation Methods
- Customers can initiate ACH payments in various ways:
  - File transfer
  - Pinnacle (online banking for corporations)
  - API
  - Payer Express
  - Pinnacle Connect
  - Integrated payables
  - E-payments (via mobile banking)
  - Electronic Data Interchange (EDI)


ACH Full Flow
- Client initiates ACH (e.g., via file to PNC).
- PNC performs file-level checks (SFG).
- PSG converts it into a proper ACH payment file.
- It goes to one of the three ACH systems for transaction-level checks.
- If everything is okay, it's sent to either the TCH or the Fed ACH network.
- Money goes to a bank, and an acknowledgment or return is sent back.
- Information is sent back to the customer regarding the status of their ACH payment.



ACH
- ACHs allow initiating both credit and debit transactions.
- ACHs allow receiving both credit and debit transactions.


RTPs (Real Time Payments)
- RTPs are processed in PRT and are ideally processed within a minute.
- FedNow is a competitor to RTP; instead of sending payments to the clearinghouse (TCH), payments are sent to the Fed.
  - FedNow is not yet live but is expected to go live later this year or next year.


Intelligent Routing in PSG
- Intelligent routing is a feature in PSG that customers must opt into.
- Customers can set preferences for how their transactions are routed (e.g., RTP, Same Day ACH, Wire).
  - PSG checks if a payment is eligible for RTP first. If it fails, it checks the next preference (e.g., Same Day ACH), and so on.
- Chip Splitter: PSG uses a "chip splitter" to decide whether to send a wire via CHIPS or FedWire.
  - If a transaction is less than $500 million and before 4 PM Eastern time, it can be sent via CHIPS. If it fails, it's sent via FedWire.
  - CHIPS stops transactions at 4 PM or 4:30 PM, while FedWire stops later (5 or 6 PM).
- PSG's intelligent routing is essentially applying business rules to decide where to send transactions.


Monitoring and Data Streaming
- PSG teams monitor the automated intelligent routing process.
- PSG, PME, and ACH platforms stream data to COD (Big Data Operations).
  - PME and PRT stream changes in their database to COD in real-time.
  - ACH sends information to COD about their transactions five times a day.
- PSG streams some data to COD, including information about payments sent via files (after the March incident) and data sent via MQ (message queue).



Lifecycle of a Transaction
- There were work efforts 4 or 5 years ago in COD to track transactions.
  - It was called lifecycle of a transaction.
  - The project was never finished, momentum ran out.
  - The current work will be similar and will probably reuse existing components.


Inputs
- Inputs were not discussed in detail.
- Recommendation: Look them up in seismic.


PMT
- PMT is not fully understood.


Zell
- Zell sometimes gets processed as RTPs and sometimes as ACHs.
  - Mostly ACHs, but some have happened as RTPs.
- ACHs create risk because the payment hasn't settled when people are told the money is available.
  - "If you are telling the people that the money is there in their account, the payment hasn't settled, so the bank doesn't have that money."


Payment Types
- RTPs, Zell over RTP, FedNow, ACHs, wires, Canada (small), Ilv (small), Swift (international wire payments).
- Swift is processed similarly to Fedwire.


Tables Involved
- ACH Transaction Master:
  - Use the COD one, not the CDI one.
  - "COD HD01PTM. Ach Transaction Master."
  - Similar to the one in CDI but has extra fields.
  - The CDI one is supposed to be decommissioned.
- Wire Master:
  - In CDI, but not used.
  - Use PME MinF instead, because Wiremaster only has completed transactions.
  - PME MinF and PRT MinF:
    - Used to make the wire view.
    - The wire view is slow because the PME MINF view and PRTMINFview is very slow.
    - PRTMinf has duplicates, PRTMinfview does not.
    - For quick queries, use PRT MinF and remove duplicates manually.


Screening
- During processing, PNC screens transactions for fraud rules and sanctions regulations.
- In COD, screenings can be viewed in these tables:
  - Message External interaction (PME and PRT).
  - There is a view and a non-view.
  - The view removes duplicates, but for quick queries, use the non-view and remove duplicates manually.



COD Tables
- PME and PRT tables contain info about accounts involved in PME and PRT transactions.
  - Routing numbers mapped to bank names can be found here.
- PSG tables are in COD as well.
  - There are two PSG transaction tables, but the speaker doesn't know the difference between them.
  - "It's payment staging digital payments transaction. That's what that's supposed to be."
- ACH transaction master table has enriched data.
  - Raw ACH data can be found in AAD.
  - If the field from ACH isn't in COD, check AAD, then the mainframe.


Databases
- Data is stored across Oracle, MongoDB, and COD.
- Platforms should send data to COD for archival.
  - It's better to use COD than to connect directly to other databases.


Streamlab Publishing
- There's an issue publishing Streamlab in RS connect.
  - The error is a sub process error related to BitBucket credentials.
- In Steamzep, the account manager in terminal options shows up as "instructor" instead of the user's name, essay, PA, SAA ID, and RID link order.
- Sunita may not be helpful with Python-related issues.

==========================================


Payment Systems Detailed Notes
PSG (Payment Staging Area)
Purpose: Central collection and standardization hub for payments from multiple input sources
Key Functions:

Collects payments from various input sources
Standardizes payment formats into XML
Performs debulking (opens files, extracts individual transactions) and bulking (reassembles transactions)
Routes payments to appropriate processing platforms

Critical Issue (March-May):

Payments were duplicated or dropped between debulking and bulking processes
Duplicated payments resulted in double processing and double payments to recipients
Dropped payments resulted in missed payments, requiring PNC to pay out of pocket
Root cause: Processing errors in the debulking/bulking workflow

Intelligent Routing Features:

Customer-configurable payment preference ordering (e.g., RTP → Same Day ACH → Wire)
Automatic fallback processing if preferred method fails
CHIPS Splitter functionality for wire routing decisions

CHIPS Splitter Rules:

Transactions under $500M before 4PM ET can be sent via CHIPS instead of FedWire
If CHIPS processing extends past 4PM cutoff, automatically routes to FedWire
CHIPS cutoff: 4:00-4:30 PM ET, FedWire cutoff: 5:00-6:00 PM ET

Data Streaming:

Streams to COD (limited data set)
Started streaming file-based payment data to COD after March incident
MQ (Message Queue) data gets streamed to COD
Does not stream all transaction details to COD

PME (Payments Engine) / GPP (Global Payments Platform)
Technical Details:

PME is the bank's internal name; GPP is the vendor product name
Vendor tool (possibly IBM, vendor not confirmed)
Handles three wire types: FedWire, SWIFT, SWIFT pass-throughs

Database Tables:

PMEMINF: Contains all PME messages/transactions (including incomplete)
PMEMINFView: Deduplicated view (slower performance due to full history scan)
PME_CUSTOMERS: Account and routing number information
Message_External_Interaction_PME: Fraud and sanctions screening data

Processing Features:

Real-time screening for fraud detection
Sanctions compliance screening
Streams transaction changes to COD in real-time

Performance Notes:

PMEMINF table has duplicates (original + updated transactions)
PMEMINFView removes duplicates but scans entire payment history (slow)
For quick queries: use PMEMINF directly and handle deduplication manually

PRT (Payment Real Time)
Technical Relationship:

Second instance of GPP vendor tool (different version than PME)
Managed by the same PME team
Slightly different version number than PME

Payment Types Handled:

CHIPS wires
ILV (International Low Volume payments)
Canada wires
Canada ACH
RTP (Real Time Payments)

Database Structure:

PRTMINF: All PRT messages/transactions
PRTMINFView: Deduplicated view
PRT_CUSTOMERS: Account information
Message_External_Interaction_PRT: Screening data

Future Integration:

May integrate with IPF for FedNow processing
FedNow implementation timeline: later 2025 or 2026

ACH Processing Systems
Three Separate Platforms:

PEP (or PEP Plus)
ACH
AUTYP (or AUT)

Processing Characteristics:

Each platform handles different subsets of ACH transactions
All three send processed transactions to TCH (The Clearing House)
Subset also sends to Fed ACH Network
Updates COD five times daily (not real-time like wire systems)

File vs. API Processing:

Batch ACH files: No debulking/bulking in PSG (different from wires)
API ACH: May undergo debulking/bulking process
Bulk of PNC ACH volume is batch file processing

Transaction Visibility Issue:

PSG and input systems don't examine individual transactions in ACH files
First transaction-level validation occurs at ACH processing platforms
Duplicate detection happens too late in the process
Should ideally catch duplicates at file receipt stage

Database Access:

COD.ACH_TRANSACTION_MASTER: Primary table for ACH data analysis
CDI version exists but is being decommissioned
COD version has additional fields not in CDI
Raw ACH data available in AAD platform (limited access)

Input Systems
Multiple Customer Initiation Methods:

File Transfer: Batch files containing multiple transactions
Pinnacle: Corporate online banking platform
API: Direct automated connections
Payer Express: Alternative payment method
Pinnacle Connect: Additional Pinnacle integration
Integrated Payables: Recurring bill payment system
ePayments: Mobile banking payments
Electronic Data Interchange (EDI): Structured business transactions

Processing Flow:

Customer initiates payment via any input method
File-level validation (not transaction-level)
Format standardization
Routing to PSG for further processing

RTP (Real Time Payments)
Processing Characteristics:

Target processing time: Under 1 minute
Processed through PRT platform
Routed to TCH (The Clearing House) for settlement
Can be initiated via API and MQ (Message Queue)

FedNow Competition:

FedNow is competing RTP system
PNC initially didn't want to support but now required to
Will route to Fed instead of TCH
Processing through PRT → IPF → Fed (architecture not finalized)
Not yet live (expected 2025-2026)

Zelle Integration
Processing Methods:

Most Zelle transactions processed as ACH
Some processed as RTP
ACH-based Zelle creates settlement risk (money shown as available before actual settlement)
RTP-based Zelle settles immediately

Risk Considerations:

Bank provides immediate availability for ACH-based Zelle
Actual settlement takes 1-2 days
Creates exposure risk if volume exceeds regulatory limits

International and Specialty Systems
SWIFT

International wire payment processing
Similar processing flow to FedWire
Handled through PME platform

Canada Payments

Canada wires and Canada ACH processed through PRT
Routed to Royal Bank of Canada (RBC) for final settlement

ILV (International Low Volume)

Small international payments
Processed through PRT
Routed to Visa for settlement

Data Architecture and Monitoring
COD (Operational Big Data)

Real-time and near-real-time data warehouse
Updates more frequently than daily (vs. BDP/BDA daily updates)
PME/PRT: Real-time streaming
ACH platforms: 5x daily updates
PSG: Limited streaming (files and MQ data)

Historical Context

"Lifecycle of a Transaction" project attempted 4-5 years ago
Never fully completed due to resource constraints
Some infrastructure remains and may be leveraged for new initiatives

Table Performance Considerations

Non-view tables with manual deduplication often faster than automated views
Views scan entire transaction history for deduplication
For quick analysis, use base tables and handle duplicates programmatically

Screening and Compliance
Two Primary Screening Types:

Fraud Detection: Transaction pattern analysis
Sanctions Compliance: Government regulation adherence

Impact on Processing:

Screening can significantly slow transaction processing
Customer complaints increase with processing delays
Can affect customer retention and business relationships

Data Availability:

Screening results stored in Message_External_Interaction tables
Available for both PME and PRT platforms
Useful for analyzing transaction processing delays
